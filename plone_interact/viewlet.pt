<tal:condition tal:condition="view/auth_token">
  <div id="plone-interact-overlay" ng-app="task" class="overlay overlay-ajax">
    <div class="close plone-interact-close"></div>
    <div class="pb-ajax">
      <div ng-controller="Task">
        <form class="noti-box-mine noti-box-show" ng-submit="addTask()">
          <input type="submit" class="submit" value="Add Task">
          <div class="noti-textarea-wrapper">
            <textarea ng-model="message" placeholder="Enter task description..."></textarea>
          </div>
        </form>
        <p></p>
        <div id="noti-messages" class="noti-messages">
          <div ng-cloak ng-repeat="task in messages | orderBy:'$index':true"
               ng-switch="isMine(task)">
            <div animate class="noti-box-mine" ng-switch-when="true">
              <div class="noti-leftlabel">
                <div class="noti-leftlabel-in"></div>
                <div class="noti-leftlabel-main">
                  <em>{{task.ts | date:dateFormat}}</em>
                </div>
              </div>
              <div class="noti-middlelabel">
                <div class="noti-mainmsg">{{task.content}}</div>
                <a href="#" remove="removeTask(task)" class="noti-box-done">&nbsp;</a>
              </div>
            </div>
            <div animate class="noti-box-foreign" ng-switch-default>
              <div class="noti-leftlabel">
                <div class="noti-leftlabel-in"></div>
                <div class="noti-leftlabel-main">
                  <div>
                    <em>From: {{task.from}}</em>
                  </div>
                  <div>
                    <em>{{task.ts | date:dateFormat}}</em>
                  </div>
                </div>
              </div>
              <div class="noti-middlelabel">
                <div>
                  <div class="noti-mainmsg">{{task.content}}</div>
                  <a href="#" remove="removeTask(task)" class="noti-box-done">&nbsp;</a>
                </div>
                <div>
                  <i>{{task.reason}}</i>
                </div>

              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <script type="text/javascript">
    // Add me to the end of the body. Fixes z-index issue.
    // Make sure this all takes place before angular starts to bind.
    jQuery('#plone-interact-overlay').appendTo('body');
  </script>
  <script src="../../components/angular/angular.js"
    tal:attributes="src string:${context/++resource++ploneinteract}/dist/components/angular/angular.js"
    ></script>
  <script src="https://cdn.firebase.com/v0/firebase.js"></script>
  <script src="angularfire.js"
    tal:attributes = "src context/++resource++ploneinteract/angularFire.js" 
    ></script>
  <script src="plone_interact.js"
    tal:attributes = "src context/++resource++ploneinteract/plone_interact.js"
    ></script>
  <link href="plone_interact.css" rel="stylesheet" type="text/css"
    tal:attributes = "href context/++resource++ploneinteract/plone_interact.css"
    />

  <meta name="plone-interact-auth-token"
    tal:attributes="content view/auth_token">
  <meta name="plone-interact-firebase-url"
    tal:attributes="content view/config/firebase_url">
</tal:condition>